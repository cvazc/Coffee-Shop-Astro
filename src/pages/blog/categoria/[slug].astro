---
import { CategoriesSlugSchema, CategorySchema } from "@/types"

export async function getStaticPaths() {
    const res = await fetch(`${import.meta.env.API_URL}/categories?_fields=slug`)
    const json = await res.json()
    const categories = CategoriesSlugSchema.parse(json)
    return categories.map(category => ({
        params: { slug: category.slug }
    }))
}

const { slug } = Astro.params
const categoryUrl = `${import.meta.env.API_URL}/categories?slug=${slug}`
const categoryRes = await fetch(categoryUrl)
const categoryJson = await categoryRes.json()
const category = CategorySchema.parse(categoryJson[0])

---

<h1>From Category</h1>